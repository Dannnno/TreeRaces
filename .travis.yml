language: cpp

compiler:
  - clang
  - gcc

before_install:
 - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
 - sudo add-apt-repository -y ppa:jtaylor/jtaylor
 - sudo apt-get update -qq
 - if [ "$CXX" = "clang++" ]; then 
     sudo apt-get install -y -qq libstdc++-4.8-dev;
   fi
 - if [ "$CXX" = "g++" ]; then 
     sudo apt-get install -y -qq g++-4.8; 
   fi
 - if [ "$CXX" = "g++" ]; then 
     export CXX="g++-4.8" CC="gcc-4.8"; 
   fi
 - sudo apt-get install -y libgtest-dev
 - "cd /usr/src/gtest && sudo cmake . && sudo cmake --build . && sudo mv libg* /usr/local/lib/ ; cd -"
 - sudo apt-get install -y -qq libc6-dbg
 - sudo apt-get install -y -qq valgrind
 - make tests

script:
 - make run_tests
 - make run_valgrind_tests
